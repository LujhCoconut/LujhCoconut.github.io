<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left: 0.25em solid rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    pre {
        page-break-inside: avoid;
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.mac-os #write{
    caret-color: AccentColor;
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



</style>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="http://yandex.st/highlightjs/6.2/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>
<style type="text/css">
		#category a{
			text-decoration: none; 
			color: black;
		}
		/* #category {line-height: 2em;} */
		.newh{
			padding-top: 0.5em;
			padding-bottom: 0.5em;
		}
		.newh:hover{
			background: #E6F0FE;
		}
    @media (max-width: 1200px) {
        .book-body {
            /* padding-left: 200px; */
            padding-right: 0px;
        }
    }

    @media (max-width: 1200px) {
        .book-body {
            /* padding-left: 200px; */
            padding-right: 0px;
        }
    }

    @media (max-width: 1200px) {
        .book-body {
            /* padding-left: 300px; */
            padding-left: 0px;
        }
    }

    @media (max-width: 700px) {
        .book-body {
            padding-left: 0px;
        }
    }

    @media (min-width: 600px) {
        #category {
            /* 绝对定位 */
            position: fixed;
            /* 目录显示的位置 */
						float: left;
						margin-right: 2em;
            /* right: 0px; */
            top: 0;
            /* 目录栏的高度,这里设置为60%主要是为了不挡住返回顶部和折叠按钮 */
            height: 93%;
            /* 设置边框这样和正文对比比较明显 */
            border: 0 solid #eaeaea;
            /* 开启垂直滚动条 */
            overflow-y: scroll;
						width:25%;
						display:block;
						/* z-index: 99;; */
						background: white;
						
        }

        /* 正文的样式 */
        #write {
            width:100%;
            display: block;
						/* float:right; */
        }
        img{
        	display: block;
        }
				
        code,tt{
            color:#c7254e;
            background-color:#f9f2f4;
        }
				
        /* 返回顶部按钮样式 */
        #topButton {
            position: fixed;
            float: right;
            right: 10px;
            top: 95%;
						z-index: 99;
        }

        /* 展开或者折叠 */
        #foldOrUnfold {
            position: fixed;
            float: right;
            right: 10px;
            top: 89%;
						z-index: 99;
        }
    }

    @media (-webkit-max-device-pixel-ratio: 1) {
        ::-webkit-scrollbar-track-piece {
            background-color: #FFF
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px
        }

        ::-webkit-scrollbar-thumb {
            background-color: #c2c2c2;
            background-clip: padding-box;
            min-height: 28px
        }

        ::-webkit-scrollbar-thumb:hover {
            background-color: #A0A0A0
        }
    }
		@media (max-width: 400px) {
			#category {
					/* 绝对定位 */
					position: fixed;
					/* 目录显示的位置 */
					float: left;
					/* right: 0px; */
					top: 0;
					width: 45%;
					/* 目录栏的高度,这里设置为60%主要是为了不挡住返回顶部和折叠按钮 */
					height: 90%;
					/* 设置边框这样和正文对比比较明显 */
					border: 2px solid #eaeaea;
					/* 开启垂直滚动条 */
					overflow-y: scroll;
					z-index: 99;
					display: none;
					background: white;
					font-size: 20px;
					/* line-height: 2em; */
			}
			
			/* 正文的样式 */
			#book_body {
					width: 100%;
					display: block;
			}
			img{
				display: block;
			}
			code,tt{
					color:#c7254e;
					background-color:#f9f2f4;
			}

			/* 返回顶部按钮样式 */
			#topButton {
					position: fixed;
					float: right;
					right: 2%;
					top: 95%;
					z-index:99;
			}

			/* 目录展开或者折叠 */
			#foldOrUnfold {
					position: fixed;
					float: left;
					right: 4%;
					top: 90%;
					z-index:99;
			}
	}
</style>
<!--侧栏目录生成代码-->
<script>
    $(document).ready(function () {
        $("h1,h2,h3,h4,h5,h6").each(function (i, item) {
            //获取标签的名字,h1,还是h2
            var tag = $(item).get(0).localName;
            //为该标签设置id属性
            $(item).attr("id", "wow" + i);
            //添加一个页内超链接,并设置class选择器
            $("#category").append('<div class="newh"><a class="new' + tag + '" href="#wow' + i + '">' + $(item).text() +
                '</a></div>');
            //为每一个标题超链接的class属性设置左边距
            $(".newh1").css("margin-left", "0em");
            $(".newh2").css("margin-left", "1em");
            $(".newh3").css("margin-left", "2em");
            $(".newh4").css("margin-left", "3em");
            $(".newh5").css("margin-left", "4em");
            $(".newh6").css("margin-left", "5em");
						$(".newh1").css("font-size", "1.5em");
						$(".newh2").css("font-size", "1.2em");
						$(".newh3").css("font-size", "1em");
						$(".newh4").css("font-size", "0.9em");
						$(".newh5").css("font-size", "0.8em");
						$(".newh1").css("font-weight", "bold");
						$(".newh2").css("font-weight", "bold");
        });
        //设置class选择器为.book-body的html内容
        $(".book-body").html($(".book-body").nextAll())
				$(".newh").on("click",function(){
					console.log($(this).children("a"));
					$(this).children("a")[0].click();
				});
    });
</script>
<script>
    // 展开或者折叠目录功能
    function showOrCloseCategory() {
        var id = document.getElementById("category");
        var write = document.getElementById("write");
				//console.log(id.style.display);
        //如果展开了
        if (id.style.display == 'block') {
            //console.log("开始展开");
            id.style.display = 'none';
						write.style.float = "";
						write.style.left = "0em";
        }
        //如果被折叠了
        else if (id.style.display == 'none') {
            //console.log("开始折叠");
            id.style.display = 'block';
						write.style.float = "right";
						write.style.left = "1em";
        }
    }
    // 返回顶部功能
    function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
    }
</script>
<!--返回顶部-->
<button onclick="topFunction()" id="topButton">TOP↑</button>
<button onclick="showOrCloseCategory()" id="foldOrUnfold">目录</button>

<!--文章主体部分-->
<div class="book-body" id="book_body"> </div>
<!--目录栏-->
<div class="book-summary" id="category" style="display:none"></div>
<title>PET_EuroSys</title>


</head>
<script src="../../autoload.js"></script>
<p><a class="resume-link" href="../../index.html">返回主页</a><br/><a class="resume-link" href="../">返回上一页</a></p>
<body class='typora-export os-windows'><div class='typora-export-content'>
    <div id='write'  class=''><h1 id='pet-eurosys25'><span>PET [EuroSys&#39;25]</span></h1><p><span>【Title】 PET: Proactive Demotion for Efficient Tiered Memory  Management</span></p><h2 id='comments'><span>Comments</span></h2><p><span>感觉这篇文章需要吐槽的有很多，我没有觉得这是一个很好的工作。当然，这篇文章的写作画图水平绝对一流。从我本身的理解触发，我依然不认可这篇文章能够在2025年被系统A会接收。</span></p><p><span>文章基于malloc()这种内存对象抽象出一个P块，类似于OS的Huge Page;但这实在是有太多值得商榷的点了：</span></p><ul><li><p><span>文章claim说内存对象这种一定具有很强的局部性，然后启用了GB级的P块作为升级降级的基本粒度（当然后面有提拆分成临时块）。但是一个liblinear怎么可以代表通用性？</span></p></li><li><p><span>文章核心claim的motivation是节省fast memory的usage，从而避免页面升级时极大概率需要提前降级页面的case。BTW, 这么大的P块做promotion这不是左右脑互博吗？就算是一个阈值，但如果只有少数hot page，那又怎么办呢？？？</span></p></li><li><p><span>这个P块和临时块的概念，和page &amp; subpage的概念基本上是一样，某种程度上只是都变大了，所以文章没有让我特别眼前一亮的地方。</span></p></li><li><p><span>实验缺乏和最新的tiered memory systems的对比，即使和Thermostat，TPP相比，实验的性能优势也就那样。</span></p></li><li><p><span>甚至图和图注还有benchmark对不上的错误。</span></p></li><li><p><span>......</span></p><p><span>当然可能是我理解不到位，文章大概花了4个小时左右看的。但我是reviewer，这篇文章我只会给到2分（weak reject）。当然EuroSys已经很random了，做系统的同学也总是要毕业的......</span></p></li></ul><p>&nbsp;</p><h2 id='abstract'><span>Abstract</span></h2><p><span>分层内存是一种通过将DRAM作为上层（高速内存）与低速但廉价的字节可寻址内存作为下层（低速内存）相结合，以更低成本提升主存容量的创新方案。</span><strong><span>主动降级</span></strong><span>作为高效利用分层内存的关键技术之一，</span><strong><span>即使在高速内存具有充足空闲空间时，也会将冷数据降级至低速内存</span></strong><span>。现有研究通过主动降级</span><strong><span>减少</span></strong><span>应用在高速内存中的</span><strong><span>驻留集大小</span></strong><span>，从而降低主存的高成本。此外，当热数据需求激增时，该技术有助于缓解因高速内存短缺导致的严重性能下降。</span></p><p><span>但我们发现，</span><strong><span>利用应用内存分配单元内的访问局部性特征，能够以更低系统开销实现更大的高速内存节省</span></strong><span>。为此提出新型主动降级方案PET，通过扩展降级/提升操作单元实现高效分层内存管理：将传统基于操作系统页面的操作单元（现有方案采用）扩展为PET块（P块）——其设计反映了应用的内存分配单元特性。PET还配套提供精准选择降级目标P块的机制，并在访问模式变化时快速提升已降级P块。</span></p><p><span>基于Linux内核v6.1.44的PET原型系统在评估负载中实现了39.8%（最高80.4%）的高速内存使用量下降，平均性能损失仅1.7%。当系统内存使用量超出高速内存容量时，相较标准Linux内核减轻了31%的性能下降幅度，其表现优于当前最先进的分层内存管理方案。</span></p><p>&nbsp;</p><h2 id='introduction'><span>Introduction</span></h2><p><span>分层内存系统可以降低TCO，比较cost-efficient。分层内存系统的性能受限于slow memory的访问，所以在软硬件层面有不少工作将具有 局部性/热 数据升级，伴生地选择冷数据降级。这篇文章主要的出发点不是热数据升级，而是聚焦于优化降级。</span></p><p><span>现有的OS通常采用惰性降级的策略，当fast memory容量低于阈值/水位线才触发冷页迁移。但该策略可能导致高速内存容量不足，迫使系统在分配高频访问数据（热数据）前就必须降级冷页[41,60,63]，同时也会限制系统中其他并发应用可用的高速内存资源。</span></p><blockquote><p><span>换句话说，就是因为把fast memory一直放的比较满，就会导致（几乎）每一次提升热页都会首先需要触发一次冷页面降级，从而影响系统的并发性能</span></p></blockquote><p><span>所以就有了主动降级的工作，通过减少应用在fast memory的驻留集大小（&lt;25%），降低对fast memory的占用，避免上面注释说的问题。基于数据中心应用中冷页占比普遍较高（平均30-40%），主动降级策略可以更激进,有望以更低性能开销实现更大的高速内存使用量削减。</span></p><blockquote><p><span>我觉得分层内存系统比较chanllenge的点其实是识别冷数据，我总是觉得识别热数据的方法有很多，但是识别冷数据的方案不太多。</span></p></blockquote><p><span>为实现激进式主动降级，建立科学的降级标准与管理单元至关重要，以精准识别不影响性能的冷数据。基于硬件性能监控单元的分析，我们发现基准测试程序通常在其内存分配单元（如malloc()分配的内存对象）内部呈现访问局部性特征。为深入探究内存分配单元特性，我们通过手动修改应用程序，采用该单元进行激进式降级与提升操作。优化后的二进制文件可实现13.2%至84.7%的高速内存使用节省，而性能损失仅轻微增加（0.76%-2.82%），这证明了基于内存分配单元的管理方案具有可行性。</span></p><p><span>我们提出名为PET（高效分层内存管理的主动降级方案）的新型主动降级机制，该方案利用</span><strong><span>内存分配单元内的访问局部性特性</span></strong><span>。通过从操作系统管理虚拟地址空间的数据结构中提取PET块（P块）——其可近似模拟内存分配单元，我们将管理单元从操作系统页扩展至P块。基于P块内部的访问局部性，PET仅通过采样P块中的页来追踪访问模式。该方案采用多级判断机制（包括P块分割与部分预降级探测），对未被访问的P块执行降级操作。这种P块粒度的降级能以极低性能开销显著减少高速内存使用。</span></p><p><span>此外，PET引入冷文件页降级功能以进一步提升高速内存节省效果。最后，方案提供P块粒度提升机制：通过动态调整的提升阈值，在低速内存访问导致的性能下降超出可容忍程度前，及时重新提升已降级的P块。</span></p><blockquote><p><span>PET还区分了匿名页和文件页？</span></p></blockquote><p><span>本文的核心贡献如下：</span></p><p><span>• 通过实验观测</span><strong><span>发现</span></strong><span>基准测试程序在内存分配单元内普遍呈现访问局部性特性，经手动修改的优化二进制文件在该单元内执行主动降级/提升操作，</span><strong><span>能以低性能开销实现大幅高速内存使用削减</span></strong><span>（§3）；</span></p><p><span>• 提出PET主动降级方案，通过捕获近似内存分配单元的P块（§4.1），实现P块粒度的数据降级目标精准识别（§4.2）；</span></p><p><span>• 设计提升机制，通过追踪已降级P块的访问状态，在影响系统性能前及时执行提升操作（§4.3）；</span></p><p><span>• 当聚合工作集适配高速内存容量时，PET能以仅1.7%的性能下降实现39.8%（最高80.4%）的高速内存使用削减；当内存使用量超出高速内存容量时，较默认Linux内核减轻31%的性能下降（§5）。</span></p><p>&nbsp;</p><h2 id='background'><span>Background</span></h2><h3 id='os-level-management-for-tiered-memory'><span>OS-level Management for Tiered Memory</span></h3><p><span>正如我上面说的，判断冷页的方法相对判断热页来说不太懂。OS的LRU链表是一种，但本质上是基于局部性。剩下的扫PTEs,或者诱发page faults来track页状态，本质上和识别热数据的方式是一样的，不是热的数据那就是冷的数据；还有就是性能计数器PEBS等等。每种方法各有优势，选择最适合自身机制的方案至关重要。具体的机制，前面分层内存的笔记写了很多，不再赘述。</span></p><p>&nbsp;</p><h3 id='demotion-with-a-tight-threshold'><span>Demotion with a Tight Threshold</span></h3><p><span>为最大限度减少低速内存访问，多数方案采用严格阈值（如linux watermark)——该标准通过限制页分配/提升操作，或强制要求提升必须伴随降级来实现。watermark设置一般不太高，使得降级仅在高速内存空闲容量不足时执行。当总工作集适配高速内存容量时，这些方案因完全使用高速内存而展现最优性能；但当总工作集规模超出高速内存容量时，高速内存的匮乏将导致分配/提升操作必须同步进行降级，进而损害系统性能。</span></p><blockquote><p><span>看到这里，难道不能适当拉大阈值，同时达到阈值异步降级冷页？</span></p></blockquote><p><span>采用Linux水印触发降级的两个代表性方案——AutoNUMA-Tiering（AN）与AutoTiering（AT）——均呈现上述特性。图1展示了当工作集规模达到高速内存容量1.5倍时，因高速内存空闲不足导致的提升失败率及AN/AT的性能下降情况（详细实验配置见§5.1）。与具备充足高速内存的系统相比，AN和AT分别表现出52.9%与37.4%的提升失败率，以及19.9%和11.1%的平均显著性能下降。其中liblinear因提升失败率最高而呈现最大性能衰减，而pr则因提升失败率较低仅出现轻微性能下降。该结果表明：当系统内存使用量超出高速内存容量时，严格阈值触发的降级机制会制约提升操作与高速内存分配。</span></p><p><img src=".\pet_f1.png" style="zoom:80%;" /></p><blockquote><p><span>这个promotion fail感觉得看代码，看一下它是怎么判断的。宏观上就是满了，所以提不上去。</span></p></blockquote><p>&nbsp;</p><h3 id='proactive-demotion'><span>Proactive Demotion</span></h3><ul><li><p><span>Far Memory与TMO建议通过将冷页（最高20%）回收至交换设备来降低昂贵主存成本，且不受高速内存使用状态影响。</span></p></li><li><p><span>TMTS和Thermostat同样聚焦通过主动降级降低内存成本，但专门针对分层内存系统：TMTS旨在用低速内存替代25%的DRAM，同时将性能衰减控制在5%以内。其通过每30秒扫描所有页的访问位识别最不常用（LFU）页进行降级，并维护冷年龄直方图追踪未访问页；Thermostat则采用不同策略——追踪每个大页的访问计数：为降低开销，其对5%的2MB大页采样，并在每个大页内重采样50个4KB页；通过毒化采样页的页表项（PTE）触发虚假页错误，以估算采样间隔内的低速内存访问次数；最终将估算值与基于用户定义性能下降阈值（3%）的预计算值比较，通过迁移操作满足目标低速内存访问量。尽管Thermostat实现了显著的高速内存节省，但因过度使用虚假页错误可能导致严重性能下降。</span></p></li><li><p><span>TPP，MEMTIS与FlexMem通过预留少量高速内存空间用于提升和分配操作，以克服§2.2所述严格阈值降级方案的局限性。</span></p><ul><li><p><span>TPP提出采用新的降级触发水印（demotion_watermark，设置为高速内存容量的2%），在达到临界内存阈值前主动降级冷页。如图1所示，TPP仅产生7.7%的提升失败率与4.7%的平均性能下降。</span></p></li><li><p><span>MEMTIS利用基于硬件的采样技术，在启用透明大页的分层内存系统中管理页布局与大小。它追踪各页访问次数的移动平均值，并维护所有页的访问直方图，优先将频繁访问（更热）的页保留在高速内存中。与TPP类似，MEMTIS在高速内存空闲空间低于预设阈值（2%）时触发降级。FlexMem在MEMTIS基础上扩展了虚假页错误访问追踪功能以提升分析精度，并采用自适应方式决定降级页数量，有效减少了提升失败。然而，由于TPP、MEMTIS和FlexMem仅</span><strong><span>为了维持少量高速内存空闲空间以改善性能而执行主动降级，未能充分发挥潜在的内存节省效益。</span></strong></p></li></ul></li></ul><p>&nbsp;</p><blockquote><p><span>现有主动降级研究主要聚焦于降低高速内存容量需求或预防因高速内存不足导致的性能下降。然而，数据中心应用中大量冷页的存在表明，通过以低性能开销降级更多冷页，存在充分发挥主动降级潜力的机遇。为实现更激进且主动的降级，必须采用不受高速内存使用状态影响的访问追踪方法——该方法需能追踪各数据未被访问的持续时间。</span></p></blockquote><p>&nbsp;</p><h2 id='exploring-aggressive-and-proactive-demotion'><span>Exploring Aggressive and Proactive Demotion</span></h2><p><span>本节旨在探究适合执行主动降级且对性能影响最小的新型管理单元。通过利用性能监控单元（PMU）进行分析，我们发现基准测试程序通常在内存分配单元（如malloc()分配的内存对象）内部呈现访问局部性特征。基于此发现，我们手动修改了多个基准测试程序的源代码，实现内存对象粒度的主动降级与提升操作。优化后的二进制文件在显著降低高速内存使用量的同时保持了较低的性能衰减，证明了基于内存分配单元的热/冷数据分类方案的可行性。</span></p><h3 id='benchmark-analysis-using-pmu'><span>Benchmark Analysis using PMU</span></h3><blockquote><p><span>PMU: 现代处理器配备有专用硬件单元，用于分析系统性能特征。PMU基于用户定义的采样周期，通过基于采样的方法统计预定义硬件事件（如TLB缺失、缓存缺失和指令周期）的发生频率。</span></p></blockquote><p><span>图2展示了liblinear运行期间发生LLC与L2 TLB缺失的虚拟地址空间随时间变化情况。黄色框表示通过malloc()分配的主要内存对象的区域和存续期。观测到的内存访问模式在单个内存对象内部呈现高度空间局部性（即整体呈现热或冷特性）。除liblinear外，其他被分析的基准程序也表现出类似的内存对象粒度访问行为。这些发现表明：区分热/冷数据的单元可从操作系统管理的页面级别扩展至内存分配单元（如内存对象），且内存分配单元可作为主动降级数据规模的判定依据。</span></p><p><img src=".\pet_f2.png" referrerpolicy="no-referrer"></p><blockquote><p><strong><span>内存对象（Memory Object）</span></strong><span> 是计算机系统中由程序或操作系统动态分配的一块连续虚拟地址空间单元，通常通过内存分配函数（如 </span><code>malloc()</code><span>、</span><code>calloc()</code><span>或 </span><code>new</code><span>）创建，用于存储特定数据或数据结构。</span></p></blockquote><h3 id='proactive-demotion-with-manually-modified-binaries'><span>Proactive Demotion with Manually Modified Binaries</span></h3><p><span>为验证在操作系统层面使用内存对象作为主动降级单元的可行性，我们通过手动修改基准测试程序源代码生成的优化二进制文件进行了实验。通过分析源代码与执行流程，我们定位了主要内存对象（如图2所示）的分配与访问代码行。基于此分析，我们构建了优化二进制文件：当检测到某个内存对象停止被访问时立即触发降级，并在其即将被重新访问前执行提升操作，这一过程通过调用页迁移系统调用（如 </span><code>move_pages()</code><span>）实现。</span></p><p><span>我们将优化二进制文件的工作集配置为适配高速内存容量，并在§5.1描述的分层内存系统中，对比了优化版本与原始版本（所有数据均分配至高速内存且无迁移操作）的性能（执行时间的倒数）及高速内存使用量。</span></p><p><img src=".\pet_f3.png" referrerpolicy="no-referrer"></p><p><span>如图3所示，优化后的二进制文件以轻微性能下降（0.76%-2.82%）为代价，实现了大幅高速内存使用削减（13.2%-84.7%）。</span></p><blockquote><p><span>这一结果表明：与现有研究采用的操作系统页粒度相比，以内存对象粒度执行主动降级/提升操作，能通过扩展迁移粒度实现更激进的降级策略，从而显著减少高速内存使用。</span></p></blockquote><p><span>若能在操作系统层面识别此类内存分配单元并用于主动降级/提升操作，无需修改源代码即可达到与优化二进制文件相当的效果，为实现高效主动降级方案提供可能。尽管内存分配单元已在多项研究中被探索[10,15,19,44,48,55,61,62]，但尚未被应用于操作系统级分层内存管理方案。</span></p><p>&nbsp;</p><h2 id='pet-aggressive-demotion-and-promotion'><span>PET: Aggressive Demotion and Promotion</span></h2><p><span>我们提出名为</span><strong><span>PET</span></strong><span>（高效分层内存管理的主动降级方案）的新型操作系统级主动降级方案。为实现激进且主动的降级，PET引入</span><strong><span>PET块（P-block）</span></strong><span>作为分层内存管理的新单元，利用操作系统层面内存分配单元内的访问局部性特性。与先前研究中的页粒度降级相比，PET基于P块的机制能更有效地识别需主动降级的目标数据。同时，凭借多步降级机制，PET能以更低的性能开销实现更大幅度的高速内存使用削减。</span></p><p><span>PET包含三大核心机制（见图4）：</span></p><ul><li><p><span>P块捕获机制</span><strong><span>：从操作系统管理虚拟地址空间的数据结构中提取新型P块（§4.1）；</span></strong></p></li><li><p><span>降级机制：基于P块信息通过多步骤执行主动降级，以低性能开销实现高速内存使用削减（§4.2）</span></p></li><li><p><strong><span>提升机制</span></strong><span>：追踪已降级P块的访问状态，当低速内存访问次数超过预设阈值时执行提升，缓解低速内存访问导致的性能下降（§4.3）。</span></p></li></ul><p><span>此外，我们在基础PET方案上扩展了</span><strong><span>文件页降级功能</span></strong><span>（§4.4）。</span></p><p><img src=".\pet_f4.png" referrerpolicy="no-referrer"></p><p>&nbsp;</p><h3 id='p-block-management-unit-for-pet'><span>P-block: Management Unit for PET</span></h3><p><span>由于在操作系统层面直接识别内存分配单元存在困难，我们通过利用操作系统的虚拟地址管理单元来近似模拟这些单元。多数操作系统通过将每个进程的虚拟地址空间划分为若干连续且不重叠的空间进行管理。每个连续虚拟地址空间具有独立属性（如访问权限），并指向进程的特定区域（如堆和栈）。这些空间在应用程序或内存分配器分配内存时创建，因此可用于捕获应用程序的内存分配单元。Linux、FreeBSD和Solaris等操作系统均具备此单元，本文后续将基于Linux的</span><code>vm_area_struct</code><span>将其称为</span><strong><span>VMA</span></strong><span>。</span></p><p><span>在全部VMA中，PET重点关注</span><strong><span>匿名mmap映射区域（anon_mmap）</span></strong><span>——该区域在应用程序或内存分配器分配大于MMAP_THRESHOLD（默认128KB）的内存时生成。我们证实anon_mmap在大多数应用（包括§3探讨的内存对象）中占据VMA的主导地位（超99%），且包含较大内存分配的anon_mmap更适合利用内存分配单元中的访问局部性。因此，PET捕获与每次内存分配对应的anon_mmap VMA，并将其作为分层内存的数据管理单元。</span></p><p><span>图5展示了liblinear分配内存对象时的P块生成流程：</span></p><ul><li><p><span>响应虚拟内存分配请求（0x83fd49000至0x8e640b870），操作系统基于页对齐地址为请求的内存对象生成新VMA（图5-①）</span></p></li><li><p><span>随后将新生成VMA与相邻VMA合并以减少VMA数量（图5-②）；</span></p></li><li><p><span>PET在合并前捕获生成VMA的单元至附加结构，该结构称为</span><strong><span>P块</span></strong><span>并作为分层内存的数据管理单元（图5-③）。</span></p></li></ul><p><span>经验证，在评估负载中P块与malloc()分配的内存对象重叠率超97%。P块信息由名为</span><code>kdemoted</code><span>的内核线程定期更新（详见§4.2）。</span></p><p><img src=".\pet_f5.png" style="zoom:80%;" /></p><p><span>为防止精度损失，PET会对过大的捕获P块（例如GB级别）执行初始分割（图5-④）。大型内存对象（如图5所示）可能同时包含热/冷数据部分。以过大粒度管理此类内存对象会降低热/冷数据分类精度，进而损害性能。因此，PET将新生成的大型P块按特定尺寸分割。我们通过敏感性研究确定了初始P块分割尺寸（详见§5.3），并将最大P块尺寸设定为1GB。</span></p><blockquote><p><code>1 GiB</code><span>??  这个读写流量放大不会很严重吗？？？？</span></p></blockquote><p><span>每个P块需要128字节的元数据（如访问计数与状态记录），但由于P块数量极少，PET的空间开销可忽略不计。在所用基准测试中，Graph500在工作集规模对应的P块数量最多——30GB工作集仅分配最多217个P块，空间开销仅占0.0001%。</span></p><p>&nbsp;</p><h3 id='demotion-mechanism'><span>Demotion Mechanism</span></h3><p><span>基于P块机制，PET无需考虑高速内存总使用量即可执行降级操作，从而以微小性能影响为代价降低高速内存容量需求。专用于降级机制的内核线程kdemoted会定期更新捕获的P块信息，并以P块粒度（而非页粒度）追踪内存访问，仅需少量组件即可识别降级目标。</span><strong><span>然而，这种基于采样的方法可能频繁遗漏未采样页上的访问事件，导致冷P块识别不准确</span></strong><span>。因此，PET针对未被访问的P块执行细粒度多阶段决策流程，以精准识别降级目标。</span></p><p><span>为识别降级目标，kdemoted采用基于采样的方法（见图6）：利用P块内的访问局部性特性，仅追踪每个P块中的单个页，以此判断P块是否被访问。kdemoted通过两种不同周期（采样间隔/扫描间隔）定期唤醒：</span></p><ul><li><p><strong><span>采样间隔</span></strong><span>（例如数百毫秒）：随机采样每个P块中的一个页，清空采样页的PTE访问位（若该页被访问则访问位会被置位）；</span></p></li><li><p><strong><span>扫描间隔</span></strong><span>（例如采样间隔的数十倍）：收集追踪信息并识别降级目标P块。</span></p></li></ul><p><span>采样间隔结束后，PET通过检查访问位在上一采样间隔内是否被置位，验证P块的访问状态。这种基于采样的方法通过PTE访问位最小化访问追踪的页表遍历开销。kdemoted将扫描间隔内未检测到访问的P块判定为冷数据。</span></p><p><img src=".\pet_f6.png" style="zoom:80%;" /></p><p><span>PET根据冷热程度将每个P块划分为四种状态：NORMAL（正常）、PHASE1（阶段1）、PHASE2（阶段2）和DEMOTED（已降级）。PET初始将P块分配在高速内存中并设置为NORMAL状态（图7）。在每个扫描间隔，系统会根据P块的冷热程度更新其状态：</span></p><ul><li><p><span>若处于NORMAL状态的P块被访问追踪机制判定为冷数据，kdemoted会将其切换至PHASE1状态，并启动更细粒度的访问追踪。</span></p></li></ul><p><img src="D:\homepage\EuroSys\PET_25\pet_f7.png" style="zoom:80%;" /></p><p><span>由于P块通常大于操作系统页尺寸，部分P块可能同时包含热数据块和冷数据块。若仅通过追踪P块内采样页来确定降级目标，可能导致误判。为解决此问题，当P块转入PHASE1状态时，PET会将其分割为若干临时块（图7-(a)与图8-①）。访问追踪机制从每个临时块中采样页，并以临时块粒度判定冷热状态。通过对临时块的精细化追踪，PET能更精确地监控内存访问模式，从而实现更准确的降级目标识别。</span></p><ul><li><p><span>对于处于PHASE1状态的P块，PET会比较扫描间隔内未被访问的临时块（冷块）与已被访问临时块（已访问块）的总尺寸。若冷块总尺寸大于已访问块，PET会将P块切换至PHASE2状态（降级前的最终阶段）。对于PHASE2状态的P块，PET会随机选择并降级部分临时块（称为</span><strong><span>探测页</span></strong><span>），以进一步提升访问追踪精度：</span></p><ul><li><p><span>将探测页的保护标志设置为PROT_NONE，使其首次访问触发虚假页错误；</span></p></li></ul><ul><li><p><span>处理虚假页错误时，PET会递增故障页所属临时块的访问计数器。</span></p></li></ul></li></ul><blockquote><p><span>Q1: 这里的block指的是什么？？多大？？？ 是否比2MB Page大 ？？</span></p><p><span>Q2: 我理解这个P块本质上不就是一个类似Huge Page的东西吗？ 这个block就类似于subpage。冷的识别从P块开始，冷的话在细分来看。图里是把它切成一行来看。（这个阶段就是进入PHASE 1）。</span></p><ul><li><p><span> ok,有做敏感性实验</span></p></li></ul><p><span>Q3: “若冷块总尺寸大于已访问块，PET会将P块切换至PHASE2状态（降级前的最终阶段）”依据是什么？ 难道冷临时块的数量少就不对其降级吗？？？</span></p></blockquote><p><span>我们谨慎设定探测页（canary pages）的比例，以精准评估P块的冷热状态：比例过小会降低降级/提升精度，而过高的比例可能导致不必要的降级开销。最终将探测页比例设置为临时块的</span><strong><span>10%</span></strong><span>，以平衡精度与开销。</span></p><p><span>对于处于PHASE2状态的P块，若其内部冷块总尺寸大于已访问块，PET则将其视为降级目标。针对内部访问模式不一致的P块，PET会根据临时块的冷热状态进行分割：在此过程中，将属性相同（均为已访问或冷）的相邻临时块合并为一个P块（图7-(c)与图8-②）。最终，PET将已访问的P块切换回NORMAL状态并提升其中的探测页；而对合并后的冷块P块执行降级操作并转换为DEMOTED状态，以此主动预防高速内存容量不足。</span></p><blockquote><p><span>Q4: 这样的方式不会使得内存布局很乱吗？？</span></p></blockquote><p><span>PET的降级机制共包含</span><strong><span>五个用户可配置参数</span></strong><span>（采样/扫描间隔、最大P块尺寸、临时块尺寸、探测页比例）。这些参数的默认值均基于敏感性研究（§5.3）中普遍表现最优的配置设定。</span></p><p><img src=".\pet_f8.png" referrerpolicy="no-referrer"></p><h3 id='promotion-mechanism'><span>Promotion Mechanism</span></h3><p><span>PET同时执行</span><strong><span>提升操作</span></strong><span>，以快速检测并响应应用内存访问模式的变化，从而减少损害性能的低速内存访问。由于P块内存在访问局部性，访问一个页常会触发同一P块内其他页的访问。因此，PET以P块粒度识别提升目标。</span></p><blockquote><p><span>？？？？？？</span></p><p><span>“由于P块内存在访问局部性，访问一个页常会触发同一P块内其他页的访问”，虽然motivation说malloc什么的内存对象具有这个性质。但换个方式理解，假设是系统开Huge Page，里面被访问的4KB Page会很多吗？？ Page里也不是所有cacheline都会被访问，motivation是为了节省fast memory的空间，但这个promotion不是背道而驰吗？？？ 纯粹的为了把P块这个故事讲好，补齐的一部分。</span></p></blockquote><p><span>尽管现有研究提出了有效的提升机制，但其基于页的方法直接适配于P块管理并不合适：例如，仅因少量页访问（如1-2次页错误[41]或8次加载[52]）就提升整个P块会高估其热性，导致不必要的提升与降级循环；若按P块尺寸缩放提升阈值虽可提高精度，但会引发过多页错误与提升延迟。</span></p><blockquote><p><span>这纯是自己机制引入的问题</span></p></blockquote><p><span>因此，我们提出专为P块粒度设计的提升机制：</span></p><ul><li><p><strong><span>精准探测</span></strong><span>：仅在探测页（canary pages）上触发虚假页错误，以低成本及时捕捉访问模式变化；</span></p></li><li><p><strong><span>异步提升</span></strong><span>：将提升决策与实际执行分离——页错误处理程序仅递增故障页所属P块的访问计数，若满足提升条件则向</span><strong><span>kpromoted内核线程</span></strong><span>发起提升请求，避免在错误处理关键路径中提升整个P块带来的性能惩罚。</span></p></li></ul><p><span>为实现精准的提升目标选择，</span><strong><span>首次对已降级P块的虚假页错误不会立即触发提升</span></strong><span>。PET允许持续访问低速内存中的已降级P块，直至达到目标低速内存访问速率阈值，以此确保仅被少量访问后再度变冷的P块不会被过早提升。通过避免大型P块的过早提升，我们同时防止了高速与低速内存带宽的低效使用，以及高速内存容量的无效耗散。</span></p><p><span>PET的提升机制设定</span><strong><span>系统级目标低速内存访问速率Rpromo</span></strong><span>，其表示每秒允许的虚假页错误数量，并基于Thermostat[2]的以下公式计算：该公式根据误降级惩罚（即单次虚假页错误引发的额外延迟）计算满足用户可容忍性能下降的Rpromo值。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n354" cid="n354" mdtype="math_block" data-math-tag-before="0" data-math-labels="[]" data-math-tag-after="0"><div class="md-rawblock-container md-math-container" contenteditable="false" tabindex="-1"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="53.1ex" height="5.041ex" role="img" focusable="false" viewBox="0 -1337 23470.3 2228" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -2.016ex;"><defs><path id="MJX-73-TEX-I-1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path id="MJX-73-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-73-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-73-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-73-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-73-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-73-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-73-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJX-73-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-73-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-73-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-73-TEX-N-A0" d=""></path><path id="MJX-73-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-73-TEX-I-1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJX-73-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-73-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-73-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-73-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-73-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-73-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D445" xlink:href="#MJX-73-TEX-I-1D445"></use></g><g data-mml-node="TeXAtom" transform="translate(792,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-73-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(503,0)"><use data-c="1D45F" xlink:href="#MJX-73-TEX-I-1D45F"></use></g><g data-mml-node="mi" transform="translate(954,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(1439,0)"><use data-c="1D45A" xlink:href="#MJX-73-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(2317,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g></g></g><g data-mml-node="mo" transform="translate(3101.1,0)"><use data-c="3D" xlink:href="#MJX-73-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(4156.9,0)"><use data-c="1D461" xlink:href="#MJX-73-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(4517.9,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(5002.9,0)"><use data-c="1D459" xlink:href="#MJX-73-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(5300.9,0)"><use data-c="1D452" xlink:href="#MJX-73-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(5766.9,0)"><use data-c="1D45F" xlink:href="#MJX-73-TEX-I-1D45F"></use></g><g data-mml-node="mi" transform="translate(6217.9,0)"><use data-c="1D44E" xlink:href="#MJX-73-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(6746.9,0)"><use data-c="1D44F" xlink:href="#MJX-73-TEX-I-1D44F"></use></g><g data-mml-node="mi" transform="translate(7175.9,0)"><use data-c="1D459" xlink:href="#MJX-73-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(7473.9,0)"><use data-c="1D452" xlink:href="#MJX-73-TEX-I-1D452"></use></g><g data-mml-node="mtext" transform="translate(7939.9,0)"><use data-c="A0" xlink:href="#MJX-73-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(8189.9,0)"><use data-c="1D460" xlink:href="#MJX-73-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(8658.9,0)"><use data-c="1D459" xlink:href="#MJX-73-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(8956.9,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(9441.9,0)"><use data-c="1D464" xlink:href="#MJX-73-TEX-I-1D464"></use></g><g data-mml-node="mi" transform="translate(10157.9,0)"><use data-c="1D451" xlink:href="#MJX-73-TEX-I-1D451"></use></g><g data-mml-node="mi" transform="translate(10677.9,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(11162.9,0)"><use data-c="1D464" xlink:href="#MJX-73-TEX-I-1D464"></use></g><g data-mml-node="mi" transform="translate(11878.9,0)"><use data-c="1D45B" xlink:href="#MJX-73-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(12701.1,0)"><use data-c="D7" xlink:href="#MJX-73-TEX-N-D7"></use></g><g data-mml-node="mfrac" transform="translate(13701.3,0)"><g data-mml-node="mrow" transform="translate(2158,676)"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-73-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(433,0)"><use data-c="1D44E" xlink:href="#MJX-73-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(962,0)"><use data-c="1D45B" xlink:href="#MJX-73-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(1562,0)"><use data-c="1D44E" xlink:href="#MJX-73-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(2091,0)"><use data-c="1D45F" xlink:href="#MJX-73-TEX-I-1D45F"></use></g><g data-mml-node="mi" transform="translate(2542,0)"><use data-c="1D466" xlink:href="#MJX-73-TEX-I-1D466"></use></g><g data-mml-node="mtext" transform="translate(3032,0)"><use data-c="A0" xlink:href="#MJX-73-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(3282,0)"><use data-c="1D45F" xlink:href="#MJX-73-TEX-I-1D45F"></use></g><g data-mml-node="mi" transform="translate(3733,0)"><use data-c="1D44E" xlink:href="#MJX-73-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(4262,0)"><use data-c="1D461" xlink:href="#MJX-73-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(4623,0)"><use data-c="1D456" xlink:href="#MJX-73-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(4968,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g></g><g data-mml-node="mrow" transform="translate(220,-686)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-73-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D456" xlink:href="#MJX-73-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(1223,0)"><use data-c="1D460" xlink:href="#MJX-73-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(1692,0)"><use data-c="1D451" xlink:href="#MJX-73-TEX-I-1D451"></use></g><g data-mml-node="mi" transform="translate(2212,0)"><use data-c="1D452" xlink:href="#MJX-73-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(2678,0)"><use data-c="1D45A" xlink:href="#MJX-73-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(3556,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(4041,0)"><use data-c="1D461" xlink:href="#MJX-73-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(4402,0)"><use data-c="1D456" xlink:href="#MJX-73-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(4747,0)"><use data-c="1D45C" xlink:href="#MJX-73-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(5232,0)"><use data-c="1D45B" xlink:href="#MJX-73-TEX-I-1D45B"></use></g><g data-mml-node="mtext" transform="translate(5832,0)"><use data-c="A0" xlink:href="#MJX-73-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(6082,0)"><use data-c="1D45D" xlink:href="#MJX-73-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(6585,0)"><use data-c="1D452" xlink:href="#MJX-73-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(7051,0)"><use data-c="1D45B" xlink:href="#MJX-73-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(7651,0)"><use data-c="1D44E" xlink:href="#MJX-73-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(8180,0)"><use data-c="1D459" xlink:href="#MJX-73-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(8478,0)"><use data-c="1D461" xlink:href="#MJX-73-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(8839,0)"><use data-c="1D466" xlink:href="#MJX-73-TEX-I-1D466"></use></g></g><rect width="9529" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>R</mi><mrow data-mjx-texclass="ORD"><mi>p</mi><mi>r</mi><mi>o</mi><mi>m</mi><mi>o</mi></mrow></msub><mo>=</mo><mi>t</mi><mi>o</mi><mi>l</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>l</mi><mi>o</mi><mi>w</mi><mi>d</mi><mi>o</mi><mi>w</mi><mi>n</mi><mo>×</mo><mfrac><mrow><mi>c</mi><mi>a</mi><mi>n</mi><mi>a</mi><mi>r</mi><mi>y</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi></mrow><mrow><mi>m</mi><mi>i</mi><mi>s</mi><mi>d</mi><mi>e</mi><mi>m</mi><mi>o</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mtext>&nbsp;</mtext><mi>p</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>y</mi></mrow></mfrac></math></mjx-assistive-mml></mjx-container></div></div><p><span>我们将可容忍性能下降设定为Thermostat采用的</span><strong><span>3%</span></strong><span>。对于误降级惩罚，我们保守采用单次提示错误的最坏情况额外延迟（而非Thermostat使用的低速内存访问延迟1μs）：通过微基准测试在提升前以缓存行粒度顺序访问降级单元，测得每页平均额外延迟为</span><strong><span>8.3μs</span></strong><span>（含低速内存访问与提升操作的开销）。基于此误降级惩罚及10%的探测页比例，计算得Rpromo为</span><strong><span>360次/秒</span></strong><span>。将Rpromo乘以采样间隔，即可得到每个采样间隔的目标低速内存访问次数th_total。</span></p><p><span>PET还按各降级P块尺寸比例分配 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.853ex" height="1.71ex" role="img" focusable="false" viewBox="0 -694 3471 756" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.14ex;"><defs><path id="MJX-75-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-75-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-75-TEX-N-5F" d="M0 -62V-25H499V-62H0Z"></path><path id="MJX-75-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-75-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-75-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-75-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(361,0)"><use data-c="210E" xlink:href="#MJX-75-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(937,0)"><use data-c="5F" xlink:href="#MJX-75-TEX-N-5F"></use></g><g data-mml-node="mi" transform="translate(1437,0)"><use data-c="1D461" xlink:href="#MJX-75-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(1798,0)"><use data-c="1D45C" xlink:href="#MJX-75-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(2283,0)"><use data-c="1D461" xlink:href="#MJX-75-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(2644,0)"><use data-c="1D44E" xlink:href="#MJX-75-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(3173,0)"><use data-c="1D459" xlink:href="#MJX-75-TEX-I-1D459"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">th\_total</script><span>，计算每个降级P块的低速内存访问次数阈值</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="8.152ex" height="1.71ex" role="img" focusable="false" viewBox="0 -694 3603 756" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.14ex;"><defs><path id="MJX-79-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-79-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-79-TEX-N-5F" d="M0 -62V-25H499V-62H0Z"></path><path id="MJX-79-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-79-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJX-79-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-79-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-79-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-79-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(361,0)"><use data-c="210E" xlink:href="#MJX-79-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(937,0)"><use data-c="5F" xlink:href="#MJX-79-TEX-N-5F"></use></g><g data-mml-node="mi" transform="translate(1437,0)"><use data-c="1D44F" xlink:href="#MJX-79-TEX-I-1D44F"></use></g><g data-mml-node="mi" transform="translate(1866,0)"><use data-c="1D459" xlink:href="#MJX-79-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(2164,0)"><use data-c="1D45C" xlink:href="#MJX-79-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(2649,0)"><use data-c="1D450" xlink:href="#MJX-79-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(3082,0)"><use data-c="1D458" xlink:href="#MJX-79-TEX-I-1D458"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">th\_block</script><span>（图9-(a)）。若通过虚假页错误统计的访问次数超过</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="8.152ex" height="1.71ex" role="img" focusable="false" viewBox="0 -694 3603 756" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.14ex;"><defs><path id="MJX-79-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-79-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-79-TEX-N-5F" d="M0 -62V-25H499V-62H0Z"></path><path id="MJX-79-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-79-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJX-79-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-79-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-79-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-79-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(361,0)"><use data-c="210E" xlink:href="#MJX-79-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(937,0)"><use data-c="5F" xlink:href="#MJX-79-TEX-N-5F"></use></g><g data-mml-node="mi" transform="translate(1437,0)"><use data-c="1D44F" xlink:href="#MJX-79-TEX-I-1D44F"></use></g><g data-mml-node="mi" transform="translate(1866,0)"><use data-c="1D459" xlink:href="#MJX-79-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(2164,0)"><use data-c="1D45C" xlink:href="#MJX-79-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(2649,0)"><use data-c="1D450" xlink:href="#MJX-79-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(3082,0)"><use data-c="1D458" xlink:href="#MJX-79-TEX-I-1D458"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">th\_block</script><span>，PET则视该P块为提升目标并唤醒kpromoted执行提升（图9-(b)）。但若提升请求累积速度超过执行能力，将引发延迟导致额外低速内存访问，可能使总量超出th_total。为将总低速内存访问速率控制在</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.388ex" height="2.195ex" role="img" focusable="false" viewBox="0 -683 2823.3 970.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.65ex;"><defs><path id="MJX-82-TEX-I-1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path id="MJX-82-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-82-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-82-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-82-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D445" xlink:href="#MJX-82-TEX-I-1D445"></use></g><g data-mml-node="TeXAtom" transform="translate(792,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-82-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(503,0)"><use data-c="1D45F" xlink:href="#MJX-82-TEX-I-1D45F"></use></g><g data-mml-node="mi" transform="translate(954,0)"><use data-c="1D45C" xlink:href="#MJX-82-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(1439,0)"><use data-c="1D45A" xlink:href="#MJX-82-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(2317,0)"><use data-c="1D45C" xlink:href="#MJX-82-TEX-I-1D45C"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mrow data-mjx-texclass="ORD"><mi>p</mi><mi>r</mi><mi>o</mi><mi>m</mi><mi>o</mi></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">R_{promo}</script><span>内，当采样间隔内聚合访问次数达到th_total时，PET会立即提升所有已访问P块（即使个别单元未达</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="8.152ex" height="1.71ex" role="img" focusable="false" viewBox="0 -694 3603 756" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.14ex;"><defs><path id="MJX-79-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-79-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-79-TEX-N-5F" d="M0 -62V-25H499V-62H0Z"></path><path id="MJX-79-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-79-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJX-79-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-79-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-79-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-79-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(361,0)"><use data-c="210E" xlink:href="#MJX-79-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(937,0)"><use data-c="5F" xlink:href="#MJX-79-TEX-N-5F"></use></g><g data-mml-node="mi" transform="translate(1437,0)"><use data-c="1D44F" xlink:href="#MJX-79-TEX-I-1D44F"></use></g><g data-mml-node="mi" transform="translate(1866,0)"><use data-c="1D459" xlink:href="#MJX-79-TEX-I-1D459"></use></g><g data-mml-node="mi" transform="translate(2164,0)"><use data-c="1D45C" xlink:href="#MJX-79-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(2649,0)"><use data-c="1D450" xlink:href="#MJX-79-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(3082,0)"><use data-c="1D458" xlink:href="#MJX-79-TEX-I-1D458"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">th\_block</script><span>）（图9-(c)），从而通过避免提升延迟期间的过量访问来最小化性能下降。</span></p><p><span>每个采样间隔结束时，PET重置低速内存访问计数器；若降级P块总尺寸变化则重新计算th_block。这种动态调整使提升机制能适应多变工作负载，保持稳健运行。</span></p><p>&nbsp;</p><h3 id='file-page-demotion'><span>File Page Demotion</span></h3><p><span>Linux通过将可迁移页分类为</span><strong><span>匿名页</span></strong><span>与</span><strong><span>文件页</span></strong><span>进行管理。匿名页占据进程虚拟地址空间的大部分，可通过P块有效管理；而文件页作为来自存储器的缓存数据独立于进程存在，需单独管理。原生内核与现有研究要么优先将文件支持页作为降级目标[31,41]，要么仅关注匿名页[16,46]。</span></p><p><span>鉴于进程通过</span><code>open()</code><span>访问文件并通过</span><code>close()</code><span>断开关联，PET将</span><strong><span>未链接至任何进程的文件</span></strong><span>（即所有打开过它的进程均调用</span><code>close()</code><span>的文件）视为降级目标。为识别此类文件，PET在每个inode中设置计数器（open_count），统计当前使用该文件的进程数。将open_count为零的inode加入由kdemoted线程管理的冷文件链表，并在每个扫描间隔降级冷文件链表中的文件。此文件页降级操作由kdemoted在后台执行，对应用性能影响极小。</span></p><p>&nbsp;</p><h3 id='comparison-with-modern-os-features'><span>Comparison with Modern OS Features</span></h3><p><span>近期在Linux中实现的</span><strong><span>多代LRU（MGLRU）</span></strong><span>[42]对传统LRU进行了改进：基于冷热程度将页分类至多个代（通常为四代），通过定期按代排序并降级最老的页实现主动降级。MGLRU的页粒度访问追踪提供高精度，但需周期性检查所有页的访问位，带来显著系统开销。</span></p><p><strong><span>数据访问监控（DAMON）</span></strong><span>[51]是Linux内核子系统，采用基于区域的采样追踪内存访问模式：它将地址空间划分为damon_region，并根据访问模式动态调整其大小，高效识别热/冷内存区域。近期基于DAMON的分层内存管理[30]被加入内核主线，利用其物理地址空间监控特性：两个内核线程分别扫描高速内存降级冷区域、扫描低速内存提升热区域。该方法显著降低监控开销，开启了基于区域的分层内存管理潜力，但仍面临以下挑战：</span></p><ul><li><p><strong><span>物理地址空间局部性缺失</span></strong></p><p><span>其监控的物理地址空间相比虚拟地址空间呈现更弱的访问局部性，导致区域级内存管理难以捕获逻辑局部性。图10显示liblinear[17]与Redis[53]的访问模式：</span></p><ul><li><p><span>liblinear在虚拟地址空间呈现明显局部性，而物理地址空间显示分散访问模式；</span></p></li><li><p><span>Redis请求遵循Zipf分布，虚拟地址空间呈现清晰时空局部性（高频访问对象聚集），但物理地址空间因映射碎片化无法体现该特性。</span></p></li></ul></li><li><p><strong><span>统一策略的运行时开销</span></strong></p><ul><li><p><span>对所有damon_region应用统一管理策略而未考虑其热性差异。如[67]所述，持续扫描与频繁区域调整会引入运行时开销，尤其对访问模式快速变化的应用影响显著。</span></p></li></ul></li></ul><p><img src=".\pet_f9.png" style="zoom:67%;" /></p><blockquote><p><span>图注都标错了！（a）liblinear写成 （a）XSBench.</span></p></blockquote><p><span>PET克服了基于DAMON的方法[30]固有的物理内存空间追踪局限性，同时通过基于区域的采样技术实现了高精度与低开销的统一。其通过监控每个进程的</span><strong><span>虚拟地址空间</span></strong><span>，可轻松识别合适的监控区域边界。为充分利用内存分配单元内的访问局部性，PET实现了P块捕获机制——在</span><code>mmap()</code><span>路径中生成新VMA时即时创建P块。</span></p><p><span>此外，PET根据P块的热度差异采用差异化追踪策略：</span></p><ul><li><p><span>对</span><strong><span>热P块</span></strong><span>采用低开销、较低精度的追踪；</span></p></li><li><p><span>对</span><strong><span>冷P块</span></strong><span>则实施更精确的追踪以防止误降级。</span></p></li></ul><p><span>该策略有效平衡了追踪开销与精度，在保持必要准确性的同时优化系统性能。</span></p><p><span>PET与[30]方案均通过内核线程实现，但线程职责分配存在本质差异：</span></p><ul><li><p><strong><span>[30]方案</span></strong><span>为每个内存层级分配独立内核线程，各线程独立监控指定层级、识别热/冷区域并迁移目标区域；</span></p></li><li><p><strong><span>PET方案</span></strong><span>采用协同工作的双线程架构：</span></p><ul><li><p><strong><span>kdemoted</span></strong><span>负责P块创建、访问追踪与降级操作；</span></p></li><li><p><strong><span>kpromoted</span></strong><span>专司提升任务。</span></p></li></ul><p>&nbsp;</p><p><span>通常kdemoted管理P块，但提升候选P块也对kpromoted可见，因此我们使用互斥锁防止资源竞争。在评估中，我们将PET与MGLRU及基于DAMON的主动降级方案对比，以凸显这些差异并证明本方法的有效性。</span></p></li></ul><p>&nbsp;</p><h2 id='evaluation'><span>Evaluation</span></h2><ul><li><p><span>“+” strength</span></p><ul><li><p><span>实验图画的很唬人，实验很多</span></p></li></ul></li><li><p><span>“-” weakness</span></p><ul><li><p><span>实验部分严重缺乏了与最近的Tiered Memory Systems的对比。</span></p></li></ul></li></ul><p><img src=".\pet_f10.png" style="zoom:67%;" /></p><p><span>GAPBS是个随机访问比较多的benchmark，PET的机制这么大的P块，即使拆成临时块也容易把这些数据踢出去，所以才有底下这个图的效果；换成</span><code>`libnear</code><span>这个在motivation重点强调的trace反而比TPP还是Thermostat高。</span></p><p><span>像Slowdown这些，说实话也每缓解多少，如果和现在的比较新的Tiered Memory Systems相比，应该是性能比不过的。我是觉得P块粒度热页提升是很违背直觉的。</span></p></div></div>
    </body>
    </html>