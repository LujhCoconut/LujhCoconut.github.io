# 动态规划

识别出题目是否适用动态规划（DP）是解题的第一步，也是最关键的一步。动态规划问题通常有以下几个**显著的特征**：

* **求最优解（Maximum/Minimum Problem）**
  * 这是DP最经典的应用场景。题目通常要求你找到一个**最大值、最小值、最长、最短**或者**最多方法数**等。
    * **最大/最小**：最大利润、最小路径和、最小编辑距离。
    * **最长**：最长递增子序列、最长公共子序列、最长回文子串。
    * **最多**：爬楼梯的方法数、兑换硬币的方法数。
* **最优子结构（Optimal Substructure）**
  * 一个问题的最优解，可以由它的**子问题的最优解**推导出来。这是DP能够成立的基础。
  * **如何判断**：问自己，“如果我知道了所有更小规模子问题的最优答案，我能不能直接推导出当前问题的最优答案？”
*  **重叠子问题（Overlapping Subproblems）**
  * 在暴力递归求解的过程中，**相同的子问题会被反复计算多次**。
  * **如何判断**：画出一个简单的递归树（哪怕只是在脑海里），看看是否有大量重复的节点

除了上述三个核心特征，还有一些常见的“题型信号”：

* **无法用贪心算法解决**：贪心算法通常“只看眼前一步”，而DP会“通盘考虑”。如果一个贪心策略无法保证得到全局最优解（例如经典的背包问题），那么它很可能需要用DP来解决。

* **问题可以被分解为多个阶段**。问题的发展过程有明显的步骤或阶段，每个阶段都有一个状态。

  * **背包问题**：阶段就是“一个一个地考虑物品”，状态就是“当前的背包容量”。
  * **买卖股票**：阶段就是“一天一天地过去”，状态就是“当天结束时是否持有股票”。

* **未来的状态只与当前状态有关，与如何到达当前状态的路径无关**

  * 这个特性被称为“**无后效性**”。也就是说，一旦当前状态确定了，那么后续决策的结果就只依赖于这个状态本身，而不依赖于你是如何达到这个状态的。

    * 在最小路径和问题中，无论你以什么路径走到 `(i, j)`这个点，从这个点开始到终点的最小路径和都是确定的。这就是“无后效性”。

    * **反例**：围棋棋局。未来的胜负不仅取决于当前的棋盘状态（棋子位置），还取决于双方的回合顺序（历史路径），这种问题就不适用DP。

      * > 当然顺序也可以是状态被考虑到状态机里，但是状态空间爆炸了。DP的强大之处在于它能高效处理**具有低维、紧凑状态空间**的问题。而围棋这类问题，其状态空间是高维、稀疏且巨大的，更适合用**蒙特卡洛树搜索 (MCTS)** 这类启发式算法，而不是标准的DP。

看到求最优解（最大/最小/最长/最多），就要立刻想到DP。然后去验证它是否具备**最优子结构**和**重叠子问题**这两个核心特性。如果都满足，接下来就是套用“定义状态 -> 写转移方程 -> 初始化 -> 计算顺序”的万能框架来解决了。



## 模板题